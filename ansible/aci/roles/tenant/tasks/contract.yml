---
- set_fact:
    aci_cred: &aci_login
      host: "{{ inventory_hostname }}"
      username: "{{ username }}"
      password: "{{ password }}"
      use_proxy: no
      use_ssl: yes
      validate_certs: no
      annotation: orchestrator:ansible
  no_log: true

- cisco.aci.aci_contract:
    <<: *aci_cred
    tenant: "{{ tenant_vars.name }}"
    contract: "{{ contract_vars.name }}"
    scope: "context"
  delegate_to: localhost

- cisco.aci.aci_contract_subject:
    <<: *aci_cred
    tenant: "{{ tenant_vars.name }}"
    contract: "{{ contract_vars.name }}"
    subject: "{{ contract_vars.subject }}"
  delegate_to: localhost

- cisco.aci.aci_contract_subject_to_filter:
    <<: *aci_cred
    tenant: "{{ tenant_vars.name }}"
    contract: "{{ contract_vars.name }}"
    subject: "{{ contract_vars.subject }}"
    filter: "{{ contract_vars.filter }}"
  delegate_to: localhost
